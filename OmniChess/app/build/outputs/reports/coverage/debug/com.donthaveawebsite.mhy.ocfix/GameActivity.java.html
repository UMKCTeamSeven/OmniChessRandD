<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GameActivity.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debug</a> &gt; <a href="index.source.html" class="el_package">com.donthaveawebsite.mhy.ocfix</a> &gt; <span class="el_source">GameActivity.java</span></div><h1>GameActivity.java</h1><pre class="source lang-java linenums">package com.donthaveawebsite.mhy.ocfix;

import android.app.Activity;
import android.graphics.drawable.Drawable;
import android.os.Bundle;
import android.view.View;
import android.widget.ImageView;
import android.view.View.OnClickListener;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

<span class="nc" id="L13">public class GameActivity extends Activity implements OnClickListener</span>

{
    Selector theselector;
    List&lt;Spot&gt; listenspots;
    Spot selectedpiecespot;
    Board mainboard;


    public void onClick(View v)
<span class="nc" id="L23">    {Spot clickedspot = null;</span>
<span class="nc bnc" id="L24" title="All 2 branches missed.">        for(Iterator&lt;Spot&gt; i = listenspots.iterator(); i.hasNext(); )</span>
        {
<span class="nc" id="L26">            Spot currspot = i.next();</span>
<span class="nc bnc" id="L27" title="All 2 branches missed.">            if (currspot.getSelector().getId() == v.getId()) {</span>
<span class="nc" id="L28">                clickedspot = currspot;</span>
<span class="nc" id="L29">                break;</span>
            }
<span class="nc" id="L31">        }</span>
<span class="nc bnc" id="L32" title="All 2 branches missed.">        if (clickedspot == null) {return;}</span>

<span class="nc bnc" id="L34" title="All 2 branches missed.">        if (tryMove(clickedspot)) return;</span>
<span class="nc bnc" id="L35" title="All 2 branches missed.">        if (deselectPiece(clickedspot)) return;</span>
<span class="nc" id="L36">        selectPiece(clickedspot);</span>
<span class="nc" id="L37">    }</span>

    private void selectPiece(Spot clickedspot) {
<span class="nc bnc" id="L40" title="All 2 branches missed.">        if(theselector.Filter(clickedspot))</span>
        {
<span class="nc" id="L42">            selectedpiecespot = clickedspot;</span>
<span class="nc" id="L43">            theselector.SelectedMode(clickedspot.getpiece(), clickedspot, listenspots, mainboard);</span>
<span class="nc" id="L44">            return;</span>
        }
<span class="nc" id="L46">    }</span>

    private boolean deselectPiece(Spot clickedspot) {
<span class="nc bnc" id="L49" title="All 6 branches missed.">        if (clickedspot != null &amp;&amp; theselector.InSelectedMode() &amp;&amp; clickedspot.SpotState == 3)</span>
        {
<span class="nc" id="L51">            selectedpiecespot = null;</span>
<span class="nc" id="L52">            clickedspot.SpotState = 2;</span>
<span class="nc" id="L53">            theselector.Deselector(clickedspot.getpiece(), clickedspot, listenspots, mainboard);</span>
<span class="nc" id="L54">            return true;</span>
        }
<span class="nc bnc" id="L56" title="All 8 branches missed.">        if (clickedspot != null &amp;&amp; theselector.InSelectedMode() &amp;&amp; clickedspot.SpotState == 2 &amp;&amp; (selectedpiecespot.piece.getcolor(selectedpiecespot.piece) == clickedspot.piece.getcolor(clickedspot.piece)))</span>
        {
<span class="nc" id="L58">            selectedpiecespot.SpotState = 2;</span>
<span class="nc" id="L59">            theselector.Deselector(selectedpiecespot.getpiece(), selectedpiecespot, listenspots, mainboard);</span>
<span class="nc" id="L60">            selectedpiecespot = null;</span>
<span class="nc" id="L61">            selectPiece(clickedspot);</span>
<span class="nc" id="L62">            return true;</span>
        }
<span class="nc" id="L64">        return false;</span>
    }

    private boolean tryMove(Spot clickedspot) {
<span class="nc bnc" id="L68" title="All 2 branches missed.">        if (clickedspot.SpotState == 0)</span>
        {

<span class="nc" id="L71">            theselector.Deselector(selectedpiecespot.getpiece(), selectedpiecespot, listenspots, mainboard);</span>
<span class="nc" id="L72">            Drawable thepiece = selectedpiecespot.getAppearance().getDrawable();</span>
<span class="nc" id="L73">            clickedspot.getAppearance().setImageDrawable(thepiece);</span>
<span class="nc" id="L74">            selectedpiecespot.getpiece().OnMove(selectedpiecespot.getpiece(),selectedpiecespot, clickedspot, mainboard);</span>
<span class="nc" id="L75">            selectedpiecespot.releaseSpot();</span>
<span class="nc" id="L76">            selectedpiecespot.getAppearance().setImageResource(R.drawable.ni_tsquare);</span>
<span class="nc" id="L77">            selectedpiecespot = null;</span>
<span class="nc" id="L78">            clickedspot.SpotState = 2;</span>
<span class="nc" id="L79">            theselector.getCurrentPlayerColor();</span>
<span class="nc" id="L80">            return true;</span>
        }
<span class="nc" id="L82">        return false;</span>
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {

<span class="nc" id="L88">        super.onCreate(savedInstanceState);</span>
<span class="nc" id="L89">        setContentView(R.layout.activity_game);</span>




<span class="nc" id="L94">        List&lt;Spot&gt; ourspots = new ArrayList&lt;Spot&gt;();</span>
<span class="nc" id="L95">        Board theboard = new Board(1, ourspots);</span>
<span class="nc bnc" id="L96" title="All 2 branches missed.">        for(Iterator&lt;Spot&gt; i = ourspots.iterator(); i.hasNext(); )</span>
        {
<span class="nc" id="L98">            StringBuilder dest = new StringBuilder(2);</span>
<span class="nc" id="L99">            String x = &quot;1234567812345678123456781234567812345678123456781234567812345678&quot;;</span>
<span class="nc" id="L100">            String y = &quot;AAAAAAAABBBBBBBBCCCCCCCCDDDDDDDDEEEEEEEEFFFFFFFFGGGGGGGGHHHHHHHH&quot;;</span>
<span class="nc" id="L101">            Spot spot = i.next();</span>

<span class="nc" id="L103">               dest.append(y.charAt(ourspots.indexOf(spot)));</span>
<span class="nc" id="L104">               dest.append(x.charAt(ourspots.indexOf(spot)));</span>


<span class="nc" id="L107">            String ps = &quot;P&quot;+ dest.toString();</span>
<span class="nc" id="L108">            String ss = &quot;S&quot;+ dest.toString();</span>
<span class="nc" id="L109">            int piecelayertier = this.getResources().getIdentifier(ps,&quot;id&quot;, getPackageName());</span>
<span class="nc" id="L110">            int selectorlayertier = this.getResources().getIdentifier(ss,&quot;id&quot;,getPackageName());</span>
<span class="nc" id="L111">            ImageView test =(ImageView)findViewById(piecelayertier);</span>

<span class="nc" id="L113">            spot.TieAppearance((ImageView)findViewById(piecelayertier));</span>
<span class="nc" id="L114">            spot.TieSelector((ImageView)findViewById(selectorlayertier));</span>
<span class="nc" id="L115">            spot.getSelector().setImageResource(R.drawable.ni_tsquare);</span>

<span class="nc" id="L117">            spot.getSelector().setOnClickListener(this);</span>

<span class="nc" id="L119">            spot.getAppearance().setImageResource(R.drawable.ni_tsquare);</span>
           // String text = spot.getAppearance().toString() + &quot; &quot; + spot.getSelector().toString();

<span class="nc" id="L122">        }</span>
<span class="nc" id="L123">    mainboard = theboard;</span>
<span class="nc" id="L124">        Pawn testpawn2 = new Pawn(true,3,1,1);</span>
<span class="nc" id="L125">        Pawn testpawn3 = new Pawn(true,5,1,1);</span>

<span class="nc" id="L127">        Knight whitetestknight = new Knight(true,  1, 7,1);</span>
<span class="nc" id="L128">        Knight testknight = new Knight(true,1,0,1);</span>

<span class="nc" id="L130">        Knight whiteknight = new Knight(true,  6, 7,1);</span>
<span class="nc" id="L131">        Knight blackknight = new Knight(true,6,0,1);</span>


<span class="nc" id="L134">        Rook whitetestrook2 = new Rook(true, 0, 7,1);</span>
<span class="nc" id="L135">        Rook whitetestrook3 = new Rook(true, 7, 7,1);</span>

<span class="nc" id="L137">        Rook blackrook = new Rook(true, 0,0, 1);</span>
<span class="nc" id="L138">        Rook blackrook2 = new Rook(true, 7,0, 1);</span>

<span class="nc" id="L140">        Bishop blackbish = new Bishop(true, 2,0,1);</span>
<span class="nc" id="L141">        Bishop blackbish2 = new Bishop(true, 5,0,1);</span>

<span class="nc" id="L143">        Bishop whitebish = new Bishop(true, 2,7,1);</span>
<span class="nc" id="L144">        Bishop whitebish2 = new Bishop(true, 5,7,1);</span>

<span class="nc" id="L146">        whitetestknight.switchcolor();</span>
<span class="nc" id="L147">        whitetestrook2.switchcolor();</span>
<span class="nc" id="L148">        whitetestrook3.switchcolor();</span>
<span class="nc" id="L149">        whiteknight.switchcolor();</span>
<span class="nc" id="L150">        whitebish.switchcolor();</span>
<span class="nc" id="L151">        whitebish2.switchcolor();</span>

<span class="nc" id="L153">        theboard.getSpot(1,0).placePiece(testknight);</span>
<span class="nc" id="L154">        theboard.getSpot(1,0).getAppearance().setImageResource(R.drawable.ni_bknight);</span>
<span class="nc" id="L155">        theboard.getSpot(1,7).placePiece(whitetestknight);</span>
<span class="nc" id="L156">        theboard.getSpot(1,7).getAppearance().setImageResource(R.drawable.ni_wknight);</span>

<span class="nc" id="L158">        theboard.getSpot(6,0).placePiece(blackknight);</span>
<span class="nc" id="L159">        theboard.getSpot(6,0).getAppearance().setImageResource(R.drawable.ni_bknight);</span>
<span class="nc" id="L160">        theboard.getSpot(6,7).placePiece(whiteknight);</span>
<span class="nc" id="L161">        theboard.getSpot(6,7).getAppearance().setImageResource(R.drawable.ni_wknight);</span>

<span class="nc" id="L163">        theboard.getSpot(2,0).placePiece(blackbish);</span>
<span class="nc" id="L164">        theboard.getSpot(2,0).getAppearance().setImageResource(R.drawable.ni_bishop);</span>
<span class="nc" id="L165">        theboard.getSpot(5,0).placePiece(blackbish2);</span>
<span class="nc" id="L166">        theboard.getSpot(5,0).getAppearance().setImageResource(R.drawable.ni_bishop);</span>

<span class="nc" id="L168">        theboard.getSpot(2,7).placePiece(whitebish);</span>
<span class="nc" id="L169">        theboard.getSpot(2,7).getAppearance().setImageResource(R.drawable.ni_bishopw);</span>
<span class="nc" id="L170">        theboard.getSpot(5,7).placePiece(whitebish2);</span>
<span class="nc" id="L171">        theboard.getSpot(5,7).getAppearance().setImageResource(R.drawable.ni_bishopw);</span>


<span class="nc" id="L174">        theboard.getSpot(0,7).placePiece(whitetestrook2);</span>
<span class="nc" id="L175">        theboard.getSpot(0,7).getAppearance().setImageResource(R.drawable.ni_rookw);</span>
<span class="nc" id="L176">        theboard.getSpot(7,7).placePiece(whitetestrook3);</span>
<span class="nc" id="L177">        theboard.getSpot(7,7).getAppearance().setImageResource(R.drawable.ni_rookw);</span>

<span class="nc" id="L179">        theboard.getSpot(7,0).placePiece(blackrook2);</span>
<span class="nc" id="L180">        theboard.getSpot(7,0).getAppearance().setImageResource(R.drawable.ni_rook);</span>
<span class="nc" id="L181">        theboard.getSpot(0,0).placePiece(blackrook);</span>
<span class="nc" id="L182">        theboard.getSpot(0,0).getAppearance().setImageResource(R.drawable.ni_rook);</span>


<span class="nc" id="L185">        theboard.getSpot(3,1).placePiece(testpawn2);</span>
<span class="nc" id="L186">        theboard.getSpot(3,1).getAppearance().setImageResource(R.drawable.ni_pawn);</span>

<span class="nc" id="L188">        theboard.getSpot(5,1).placePiece(testpawn3);</span>
<span class="nc" id="L189">        theboard.getSpot(5,1).getAppearance().setImageResource(R.drawable.ni_pawn);</span>






<span class="nc" id="L196">        Player white = new Player('W');</span>
<span class="nc" id="L197">        Player black = new Player('B');</span>
<span class="nc" id="L198">        black.setTurn(true);</span>
<span class="nc" id="L199">        List&lt;Player&gt; players = new ArrayList&lt;Player&gt;();</span>
        //For now just the black player will be added
<span class="nc" id="L201">        players.add(black);</span>
<span class="nc" id="L202">        players.add(white);</span>
<span class="nc" id="L203">        listenspots = ourspots;</span>
<span class="nc" id="L204">        theselector = new Selector(players, ourspots, theboard);</span>


<span class="nc" id="L207">    }</span>








    }//endclass



</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.1.201405082137</span></div></body></html>